Reddit MCP Adapter and Demo App v1 Plan

2. Problem and decisions (short, direct)

- Implement a Reddit adapter conforming to [Adapter](packages/mcp-core/src/types.ts:29) and registered via [defineAdapter()](packages/mcp-core/src/types.ts:100).
- v1 targets posts and comments only, derived directly from CSV in the export.
- Default DB path is CWD-local: ./.data/reddit.db, with optional override.
- Use @libsql/client directly for local LibSQL access; Turso is out of scope for v1.
- Demo app path: [apps/demo-mcp](apps/demo-mcp).
- Adapter package path: [packages/mcp-adapters/reddit](packages/mcp-adapters/reddit).

3. Directory and file structure
   Lay out the planned structure:

- [packages/mcp-adapters/reddit](packages/mcp-adapters/reddit)
  - [package.json](packages/mcp-adapters/reddit/package.json), [tsconfig.json](packages/mcp-adapters/reddit/tsconfig.json)
  - src/
    - [index.ts](packages/mcp-adapters/reddit/src/index.ts) (exports redditAdapter via [defineAdapter()](packages/mcp-core/src/types.ts:100))
    - [schema.ts](packages/mcp-adapters/reddit/src/schema.ts) (Drizzle sqlite tables)
    - [metadata.ts](packages/mcp-adapters/reddit/src/metadata.ts) (column descriptions per [ColumnDescriptions](packages/mcp-core/src/types.ts:13))
    - [parse.ts](packages/mcp-adapters/reddit/src/parse.ts) (unzip + CSV parse to parsed shape)
    - [upsert.ts](packages/mcp-adapters/reddit/src/upsert.ts) (transactional upsert logic)
    - [views.ts](packages/mcp-adapters/reddit/src/views.ts) (predefined views)
- [apps/demo-mcp](apps/demo-mcp)
  - [package.json](apps/demo-mcp/package.json), [tsconfig.json](apps/demo-mcp/tsconfig.json)
  - src/
    - [cli.ts](apps/demo-mcp/src/cli.ts) (commands: import)

4. Demo app ([apps/demo-mcp](apps/demo-mcp))
   Implement a minimal CLI with one command:

- import
  - Flags:
    - --file: path to input zip; defaults to ./export_rocket_scientist2_20250811.zip
    - --db: path to LibSQL file; default: ./.data/reddit.db under process.cwd()
  - Behavior:
    - Ensure parent folder for DB exists.
    - Open/create DB at resolved path using @libsql/client.
    - Run adapter migrations (using migrationsFolder/migrationsTable).
    - Read --file into a Blob, call adapter.parse(), validate with parseSchema, then adapter.upsert().
    - Print inserted/updated counts by table and absolute DB path.

5. Acceptance criteria

- Running the import command with the provided zip completes without error and prints row counts for posts and comments.
- The DB file is created at the CWD default path ./.data/reddit.db when no --db is provided.
- Adapter object satisfies [Adapter](packages/mcp-core/src/types.ts:29) and uses [defineAdapter()](packages/mcp-core/src/types.ts:100).
- metadata includes descriptions for every column in posts and comments tables.

6. Review (to fill after implementation)
   Summarize the final schema, any deviations from plan, and test results.

End of spec
